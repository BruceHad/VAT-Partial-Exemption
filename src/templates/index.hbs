<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width,initial-scale=1" name="viewport">
    <meta content="" name="description">
    <title>{{ title }}</title>
    <link href="css/style.css" rel="stylesheet">
    <link href="images/favicon.png" rel="icon">
</head>

<body>

    {{> header}}

    <div class="container-fluid" id="app">
        <div class="row">
            <div class="col col-md-4">
                <section class="introduction text">
                    <!--<blockquote cite="https://www.gov.uk/government/publications/vat-notice-706-partial-exemption/vat-notice-706-partial-exemption">
                        <p>A business is partly exempt if it makes, or intends to make, both taxable and exempt supplies and incurs tax on costs which relate to both.</p>
                        <p>If your business is partly exempt, you may not be able to recover all your input tax. You will have to use a partial exemption method to work out how much input tax you can recover.</p>
                        <footer><a href="https://www.gov.uk/government/publications/vat-notice-706-partial-exemption/vat-notice-706-partial-exemption">VAT Notice 706: partial exemption</a></footer>
                    </blockquote>-->
                </section>
            </div>
            <div class="col col-md-8">
                <h2>Calculation</h2>
                <p>To calculate the Partial Exemption status you have to enter Sales and VAT data for the business, for each quarter. The calculator will then apply the deminimis tests and determine the partial exemption status for the first three quarters and then the final, yearly result.</p>

                <section class="form-inline business-name">
                    <p>Enter the name of the business (optional):</p>

                    <input type="text" id="business-name" class="text" v-model.number="state.businessName" required="true" disabled="true" />
                    <button type="button" class="btn btn-default" v-on:click="editName" v-if="! editingName">Edit Name</button>
                    <button type="button" class="btn btn-default" v-on:click="saveName" v-if="editingName">Save Name</button>
                    <p style="text-align:right"><small>(id: ${bid})</small></p>

                    <button type="button" class="btn btn-default" v-on:click="addNewBusiness">Add New Business</button>
                    <select v-if="businesses" v-model="bid" class="form-control">
                        <option v-for="business in businesses"
                                :value="business.id"
                                :selected="business.selected">
                                ${business.name}  (${business.id})
                        </option>
                    </select>
                </section>


                <section class="user-inputs data">
                    <h3>Sales</h3>
                    <p>Enter the quarterly outputs (net sales).</p>
                    <table id="table-outputs" class="table table-striped table-bordered table-condensed table-inputs five-column">
                        <tr>
                            <th class="first-column">&nbsp</th>
                            <th v-for="quarter in quarters">${quarter}</th>
                        </tr>

                        <tr v-for="(row, rowkey) in state.outputs">
                            <td class="first-column">${rowkey}</td>
                            <td v-for="(value, key) in state.outputs[rowkey]">
                                <input type="number" class="form-control" v-model.number="state.outputs[rowkey][key]" :tabindex="tabOrder['outputs'][rowkey][key]" step="0.01" min="0" max="100000000" />
                            </td>
                            <td class="td-number">
                                <span>${totalYearlyOutputs[rowkey]}</span>
                            </td>
                        </tr>

                        <tr>
                            <td class="first-column">Percent Exempt</td>
                            <td v-for="(value, key) in percentsExempt" class="td-percent">
                                <span v-if="percentsExempt[key] != null">${percentsExempt[key]}%</span>
                            </td>

                        </tr>
                    </table>
                    <h3>VAT</h3>
                    <p>And enter the VAT on purchases.</p>
                    <table id="table-outputs" class="table table-striped table-bordered table-condensed table-inputs">
                        <tr>
                            <th class="first-column">&nbsp</th>
                            <th v-for="quarter in quarters">${quarter}</th>
                        </tr>

                        <tr v-for="(row, rowkey) in state.inputVAT">
                            <td class="first-column">${rowkey}</td>
                            <td v-for="(value, key) in state.inputVAT[rowkey]">
                                <input type="number" class="form-control" v-model.number="state.inputVAT[rowkey][key]" :tabindex="tabOrder['inputs'][rowkey][key]" step="0.01" min="0" max="100000000" />
                            </td>
                            <td class="td-number">
                                <span>${totalYearlyInputs[rowkey]}</span>
                            </td>
                        </tr>
                        <tr>
                            <td class="first-column">Total VAT on Inputs</td>
                            <td v-for="(value, key) in totalInputs" class="td-number">
                                <span v-if="totalInputs[key]">${totalInputs[key]}</span>
                            </td>
                        </tr>
                    </table>
                    <p><button id="reset" v-on:click="reset">Reset</button></p>
                </section>

                <section class="calculation-output data">
                    <h3>Results</h3>
                    <p>De Minimis calculation has two tests. If both pass then the business can claim back 100% of VAT.</p>
                    <table id="table-outputs" class="table table-striped table-bordered table-condensed table-inputs four-column">

                        <tr>
                            <th class="first-column">&nbsp</th>
                            <th v-for="quarter in quarters2">${quarter}</th>
                        </tr>

                        <tr v-for="(row, rowkey) in deminimis">
                            <td class="first-column">${rowkey}</td>
                            <td v-for="(value, key) in deminimis[rowkey]" v-if="key != 'Q4'">
                                <div v-if="deminimis[rowkey][key]">
                                    <c-true></c-true>
                                </div>
                                <div v-else-if="deminimis[rowkey][key] === false">
                                    <c-false></c-false>
                                </div>
                            </td>
                        </tr>

                    </table>
                </section>
            </div>
        </div>
    </div>
    <!-- end app -->

    {{> footer}}

    <script src="scripts/script.js"></script>
</body>

</html>
